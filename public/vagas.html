<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vagas ‚Äî Ezra | Conecte-se a Oportunidades com Impacto</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="icon" href="/img/logo icone.svg" />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/vagas.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="premium-header" id="premium-header">
      <nav class="premium-nav" aria-label="Menu principal">
        <a href="index.html">Home</a>
        <a href="vagas.html">Vagas</a>
        <a href="cursos.html">Cursos</a>
        <a href="artigos.html">Artigos</a>
      </nav>
      <div class="logo">
        <img src="/img/logo.svg" alt="Logo Ezra" />
      </div>
      <div class="premium-actions">
        <a href="https://linkedin.com" title="LinkedIn" target="_blank"
          ><i class="fa-brands fa-linkedin"></i
        ></a>
        <a href="https://instagram.com" title="Instagram" target="_blank"
          ><i class="fa-brands fa-instagram"></i
        ></a>
        <div class="account-icon">
          <a href="cadastro.html" title="Login / Criar conta">
            <i class="fa-solid fa-user"></i>
            <span class="account-text-roller">
              <span class="roller-text roller-cadastrar">Cadastrar</span>
              <span class="roller-text roller-entrar">Entrar</span>
            </span>
          </a>
        </div>
      </div>
    </header>

  <!-- Hero / Intro Section -->
  <section class="hero vagas-hero">
    <div class="hero-content">
      <h1 id="vagas-heading" class="vagas-title">Encontre a vaga ideal para voc√™</h1>
      <p>
        Na Ezra, conectamos talentos a empresas comprometidas com inclus√£o, diversidade e responsabilidade social. Explore nossas oportunidades e d√™ o pr√≥ximo passo na sua carreira.
      </p>
    </div>
  </section>

  <!-- Filtros de busca -->
  <section class="about vagas-filters">
    <div class="about-container">
      <form class="filters" aria-label="Filtros de vagas">
        <div class="filter-group">
          <label for="area" class="filter-label">√Årea</label>
          <select id="area" name="area" class="filter-select">
            <option value="">Todas</option>
            <option value="tecnologia">Tecnologia</option>
            <option value="administrativo">Administrativo</option>
            <option value="marketing">Marketing</option>
            <option value="servi√ßos">Servi√ßos</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="tipo" class="filter-label">Tipo de contrato</label>
          <select id="tipo" name="tipo" class="filter-select">
            <option value="">Todos</option>
            <option value="clt">CLT</option>
            <option value="pj">PJ</option>
            <option value="freelancer">Freelancer</option>
            <option value="estagio">Est√°gio</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="local" class="filter-label">Localidade</label>
          <input type="text" id="local" name="local" placeholder="Digite uma cidade" class="filter-input" />
        </div>
        <button class="btn">Buscar</button>
      </form>
    </div>
  </section>

  <!-- Bot√£o da IA -->
<section class="ia-recommendation">
  <div class="about-container" style="text-align: center; margin: 2rem 0;">
    <button class="btn" onclick="buscarVagasIA()" style="background-color:#2c3e50; color:white; padding:1rem 2rem; border:none; border-radius:8px; cursor:pointer;">
      üîç Buscar Vagas com IA
    </button>
    <div id="resultadoIA" style="margin-top:2rem; text-align:left;"></div>
  </div>
</section>


  <!-- Lista de vagas -->
  <section class="jobs vagas-list">
    <h2>Vagas em Destaque</h2>
    <div class="jobs-grid">
      <div class="job-card">
        <h3>Desenvolvedor Front-End J√∫nior</h3>
        <span class="job-company">Tech4All</span>
        <p><strong>Local:</strong> S√£o Paulo, SP (H√≠brido)</p>
        <p><strong>Descri√ß√£o:</strong> Desenvolvimento de interfaces acess√≠veis e responsivas. Valorizamos diversidade e inova√ß√£o.</p>
        <a href="#" class="see-more btn">Ver detalhes</a>
      </div>
      <div class="job-card">
        <h3>Analista de Marketing Digital</h3>
        <span class="job-company">GreenGrow</span>
        <p><strong>Local:</strong> Remoto</p>
        <p><strong>Descri√ß√£o:</strong> Planejamento de campanhas online com foco em impacto social e responsabilidade ambiental.</p>
        <a href="#" class="see-more btn">Ver detalhes</a>
      </div>
      <div class="job-card">
        <h3>Assistente Administrativo</h3>
        <span class="job-company">Inclusiva RH</span>
        <p><strong>Local:</strong> Belo Horizonte, MG</p>
        <p><strong>Descri√ß√£o:</strong> Apoio em processos internos. Vaga afirmativa para pessoas com defici√™ncia (PcD).</p>
        <a href="#" class="see-more btn">Ver detalhes</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="footer-container">
      <div class="footer-logo">
        <img src="img/logo branca.svg" alt="Ezra Logo" />
      </div>
      <div class="footer-links">
        <a href="index.html">Home</a>
        <a href="vagas.html">Vagas</a>
        <a href="artigos.html">Artigos</a>
        <a href="contato.html">Contato</a>
      </div>
      <div class="footer-social">
        <a href="#"><i class="fa-brands fa-linkedin"></i></a>
        <a href="#"><i class="fa-brands fa-instagram"></i></a>
        <a href="#"><i class="fa-brands fa-facebook"></i></a>
      </div>
      <div class="footer-cert">
        <img src="img/Design sem nome.png" alt="B-Corp Certificado" />
        <span>B-Corp & Sustentabilidade</span>
      </div>
    </div>
    <div class="footer-copy">
      &copy; 2025 Ezra. Todos os direitos reservados.
    </div>
  </footer>

  <script src="js/auth.js"></script>
  <script src="js/jobs.js"></script>
  <script>
      // Header shrink on scroll
  window.addEventListener("scroll", function () {
    const header = document.getElementById("premium-header");
    if (window.scrollY > 50) {
      header.classList.add("scrolled");
    } else {
      header.classList.remove("scrolled");
    }
  });

      const accountIcon = document.querySelector(".account-icon a");
  const rollerCadastrar = document.querySelector(".roller-cadastrar");
  const rollerEntrar = document.querySelector(".roller-entrar");
  const roller = document.querySelector(".account-text-roller");
  let intervalId;
  let showingCadastrar = true;

  function rollText() {
    if (showingCadastrar) {
      rollerCadastrar.style.transform = "translateY(0)";
      rollerEntrar.style.transform = "translateY(100%)";
    } else {
      rollerCadastrar.style.transform = "translateY(-100%)";
      rollerEntrar.style.transform = "translateY(0)";
    }
    showingCadastrar = !showingCadastrar;
  }

  accountIcon.addEventListener("mouseenter", () => {
    roller.style.opacity = 1;
    rollerCadastrar.style.transition = "transform 0.5s cubic-bezier(.77,0,.18,1)";
    rollerEntrar.style.transition = "transform 0.5s cubic-bezier(.77,0,.18,1)";
    rollText(); // Start immediately
    intervalId = setInterval(rollText, 2000);
  });

  accountIcon.addEventListener("mouseleave", () => {
    clearInterval(intervalId);
    roller.style.opacity = 0;
    rollerCadastrar.style.transform = "translateY(0)";
    rollerEntrar.style.transform = "translateY(100%)";
    showingCadastrar = true;
  });

  // Initialize positions
  rollerCadastrar.style.transform = "translateY(0)";
  rollerEntrar.style.transform = "translateY(100%)";


      function animateCountUp(el, target) {
        let count = 0;
        const speed = Math.ceil(target / 60);
        function update() {
          count += speed;
          if (count > target) count = target;
          el.textContent = "+" + count.toLocaleString();
          if (count < target) requestAnimationFrame(update);
        }
        update();
      }
      document.querySelectorAll('.impact-number').forEach(el => {
        const target = parseInt(el.getAttribute('data-count'), 10);
        animateCountUp(el, target);
      });

      // Simple testimonial carousel
      let testimonialIndex = 0;
      const testimonials = document.querySelectorAll('.testimonial-card');
      function showTestimonial(idx) {
        testimonials.forEach((card, i) => {
          card.style.display = i === idx ? 'flex' : 'none';
        });
      }
      showTestimonial(testimonialIndex);
      setInterval(() => {
        testimonialIndex = (testimonialIndex + 1) % testimonials.length;
        showTestimonial(testimonialIndex);
      }, 4000);

      async function buscarVagasIA() {
  const token = localStorage.getItem('token'); // token do login salvo
  if (!token) {
    alert("Voc√™ precisa estar logado para usar a IA de vagas!");
    return;
  }

  const userId = parseJwt(token).id; // decodifica o ID do usu√°rio

  const res = await fetch("/api/recommend", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ userId })
  });

  const data = await res.json();

  if (data.error) {
    document.getElementById("resultadoIA").innerHTML = `<p style="color:red;">${data.error}</p>`;
    return;
  }

  document.getElementById("resultadoIA").innerHTML = `
    <h3>Resultados da IA</h3>
    <p>${data.explicacao}</p>
    <ul style="margin-top:1rem;">
      ${data.recomendacoes.map(v => `
        <li style="margin-bottom:1rem;">
          <strong>${v.titulo}</strong> ‚Äî ${v.compatibilidade}% de compatibilidade
          <p>${v.descricao}</p>
        </li>
      `).join('')}
    </ul>
  `;
}

// fun√ß√£o para decodificar o JWT e pegar o userId
function parseJwt(token) {
  try {
    return JSON.parse(atob(token.split('.')[1]));
  } catch (e) {
    return null;
  }
}

 const btn = document.getElementById('chatbotBtn');
  const box = document.getElementById('chatbotBox');
  const chatArea = document.getElementById('chatArea');
  const input = document.getElementById('chatInput');
  const send = document.getElementById('sendChat');
  let history = [];

  btn.onclick = () => box.style.display = box.style.display === 'none' ? 'block' : 'none';

  async function sendMessage() {
    const message = input.value.trim();
    if (!message) return;
    chatArea.innerHTML += `<div><strong>Voc√™:</strong> ${message}</div>`;
    input.value = '';

    const res = await fetch('/api/chatbot/ask', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message, history })
    });
    const data = await res.json();
    chatArea.innerHTML += `<div><strong>Ezra IA:</strong> ${data.response}</div>`;
    chatArea.scrollTop = chatArea.scrollHeight;
    history = data.history;
  }

  send.onclick = sendMessage;
  input.addEventListener('keypress', e => {
    if (e.key === 'Enter') sendMessage();
  });
    </script>

    <button id="chatbotBtn" 
  style="position: fixed; bottom: 30px; right: 30px; background-color: #2c3e50; color: white; border: none; border-radius: 50%; width: 60px; height: 60px; font-size: 1.5rem; cursor: pointer;">
  üí¨
</button>

<div id="chatbotBox" 
  style="display:none; position: fixed; bottom: 100px; right: 30px; width: 320px; height: 400px; background: white; box-shadow: 0 0 10px rgba(0,0,0,0.2); border-radius: 10px; overflow: hidden;">
  <div style="background:#2c3e50; color:white; padding:0.5rem; font-weight:bold;">Assistente Ezra IA</div>
  <div id="chatArea" style="height:300px; overflow-y:auto; padding:0.5rem;"></div>
  <div style="display:flex; border-top:1px solid #ccc;">
    <input id="chatInput" type="text" placeholder="Pergunte algo..." style="flex:1; border:none; padding:0.5rem;">
    <button id="sendChat" style="background:#3498db; border:none; color:white; padding:0.5rem 1rem;">Enviar</button>
  </div>
</div>

</body>
</html>